# config.py

# ==========================================
# 1. 音乐结构参数 (Music Structure)
# 决定了旋律的物理形态和时间分辨率
# ==========================================
NUM_BARS = 4            # 【生成长度】旋律包含的小节数。4小节是典型的乐句长度。
BEATS_PER_BAR = 4       # 【拍号】每小节几拍。4代表 4/4 拍，这是最常见的流行音乐拍号。
STEPS_PER_BEAT = 4      # 【时间精度】每拍被切分成几份。4 代表最小单位是“十六分音符”（1拍/4）。
                        # 如果设为 2，则最小单位是八分音符；设为 12 可以支持三连音。

# 【基因长度】染色体的总长度。
# 计算公式：小节数 * 每小节拍数 * 每拍切片数
# 例如：4 * 4 * 4 = 64 个整数。这是遗传算法主要操作的列表长度。
TOTAL_STEPS = NUM_BARS * BEATS_PER_BAR * STEPS_PER_BEAT 


# ==========================================
# 2. 音高与生成约束 (Pitch & Constraints)
# 决定了旋律的听感范围和密度
# ==========================================
# 【音域范围】MIDI 编号。
# 60=中央C (C4)。50(D3) 到 84(C6) 跨越了约 3 个八度，覆盖了人声和常用乐器的主音区。
PITCH_MIN = 60          
PITCH_MAX = 84          

# 【稀疏度】生成休止符（0）的概率。
# 0.2 表示约 20% 的时间是静音的。
# 调大该值：旋律更空灵、呼吸感更强；调小该值：旋律更紧凑、密集。
REST_PROB = 0.2


# ==========================================
# 3. 遗传算法核心参数 (GA Hyperparameters)
# 决定了训练的速度和收敛质量
# ==========================================
# 【种群规模】每一代包含多少个独立的旋律。
# 2000 是一个较大的值，能保证基因多样性，避免过早陷入局部最优，但计算速度会稍慢。
POPULATION_SIZE = 1000  

# 【迭代次数】进化的总轮数。
# 500 代通常足以让旋律从随机噪音进化到符合和弦的乐句。
GENERATIONS = 100       

# 【基础变异率】基因突变的概率。
# 0.05 (5%) 代表在通过交叉产生后代后，每个音符有 5% 的概率随机变成其他音。
# 这是维持创新性的关键，防止所有旋律变得一模一样。
MUTATION_RATE_BASE = 0.05 

# 【精英策略】每代直接晋级下一代的“最强王者”数量。
# 50 代表每一代评分最高的 50 个个体不经过交叉变异，直接复制到下一代。
# 这保证了种群的最优解不会因为随机变异而丢失（虽然 50/2000=2.5% 比例适中）。
ELITISM_COUNT = 50      


# ==========================================
# 4. 伴奏与和声设置 (Accompaniment & Harmony)
# 决定了旋律的“情感背景”
# ==========================================
# 【和弦走向】定义了背景音乐的根音序列。
# 48(C3), 43(G2), 45(A2), 41(F2) 对应经典的流行走向：C大调 I - V - vi - IV
# 旋律会根据这个设置，在不同的小节“自动转调”去迎合这些根音。
CHORD_ROOTS = [48, 43, 45, 41] 

# 【和弦节奏】每个和弦持续的拍数。
# 4 代表每个和弦占满 1 个小节（全音符长度）。
CHORD_DURATION = 4